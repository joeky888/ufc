Supersedes my [previous work](https://github.com/joeky888/ugc).

Rewritten in safe rust.